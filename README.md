# HCV-NABS

## Description

HCV-NABS (**H**epatitis **C** **V**irus -- **N**eutralising **A**nti**B**odie**S**) is a linked dataset and set of analysis scripts for analysing the variation of HCV virus sequences with respect to the known binding locations of neutralising antibodies.

HCV-NABS is an open source analysis resource which accompanies the article *Predicting the Effectiveness of Hepatitis C Virus Neutralizing Antibodies by Analysis of Public Sequence Data*, Cowton et al. 2018, Manuscript submitted for publication.

HCV-NABS is based on GLUE, an open source, data-centric bioinformatics environment specialised for the analysis of virus sequence data. HCV-GLUE is the GLUE project for analysing HCV sequence data generally, and HCV-NABS is an extension to HCV-GLUE.

## Installation

You can install HCV-NABS on computers running Windows, MacOSX or Linux. Note: if you simply want to run the HCV-NABS analysis described in the accompanying article, it is not strictly necessary to install certain of GLUE's runtime dependencies such as BLAST+, MAFFT and RAxML. However you should install these if you are interested in using GLUE for general HCV sequence analysis.
1. Install GLUE, based on the [GLUE installation instructions](http://tools.glue.cvr.ac.uk/#/installation). 
2. Once GLUE is installed and working, you should download Offline HCV-GLUE and load it in to GLUE. Follow the [Offline HCV-GLUE installation instructions](http://hcv.glue.cvr.ac.uk/#/aboutGlueProject). You should select the **ncbi_hcv_glue.tar.gz** project build.
3. Clone the HCV-NABS repository into your `gluetools/projects` directory.
4. Within the `gluetools/projects/HCV-NABS` directory, start GLUE and build the HCV-NABS extension by issuing the following command in GLUE:
```
Mode path: /
GLUE> run file hcvNabsExtension.glue
```
5. This should run to completion and produce the `OK` result.

## Usage

There are three types of report which the extension can generate. In each case the report is generated by running a command in project mode (use `project hcv` to enter this mode).

1. **Characterise the geographical distribution and genotypes/subtypes of public sequence data in the E1 and E2 genome regions**
To produce the E1 report as an interactive table result run:
```
Mode path: /project/hcv
GLUE> module hcvNabsCharacterisePublicData invoke-function featureCoverageByCountryAndClade E1
```
For the E2 report:
```
Mode path: /project/hcv
GLUE> module hcvNabsCharacterisePublicData invoke-function featureCoverageByCountryAndClade E2
```
2. **Analyse the frequencies of amino acid residues for individual binding locations, by genotype**. The following command overwrites the file `tabular/bindingResiduesReport.txt` within the HCV-NABS repository:
```
Mode path: /project/hcv
GLUE> module hcvNabsReports invoke-function bindingResiduesReport
```
3. **Analyse the frequencies of motifs combining all binding locations for each antibody**. 
The following command overwrites the file `tabular/bindingMotifsReport.txt` within the HCV-NABS repository:
```
Mode path: /project/hcv
GLUE> module hcvNabsAnalyseBindingMotifs invoke-function analyse
```

## Contributing

The project could be extended, for example to look at more antibodies as their binding patterns are identified. If you are interested in extending the project in this or any other way, please contact [Josh Singer](mailto:josh.singer@glasgow.ac.uk). 

## Credits

The code was written by Josh Singer based ona specification by Vanessa Cowton. Please cite our research article: *Predicting the Effectiveness of Hepatitis C Virus Neutralizing Antibodies by Analysis of Public Sequence Data*, Cowton et al. 2018, Manuscript submitted for publication.

## License

The project is licensed under the [GNU Affero General Public License v. 3.0](https://www.gnu.org/licenses/agpl-3.0.en.html)